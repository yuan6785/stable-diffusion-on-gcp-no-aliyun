参考文档:  https://agones.dev/site/docs/installation/install-agones/helm/


# 变量设置
# 如果region是us-central1，则会开3*num-nodes的节点，因为us-central1有三个子区
# --machine-type=e2-standard-4 # custom-12-49152-ext e2-standard-4  # e2-standard-4标准类型(测试通过)， custom-12-49152-ext自定义的类型
PROJECT_ID=happyaigc
REGION=us-central1-f
CLUSTER_NAME=testagones
MACHINE_TYPE=e2-standard-4


#登录
gcloud config set project ${PROJECT_ID}  
#(输入谷歌账号的密码即可)


# 创建k8s集群
gcloud container clusters create ${CLUSTER_NAME} \
  --region=${REGION} \
  --release-channel="None" \
  --tags=game-server \
  --scopes=gke-default \
  --num-nodes=4 \
  --enable-image-streaming \
  --machine-type=${MACHINE_TYPE}

  

# 证书保存到本地
gcloud container clusters get-credentials ${CLUSTER_NAME} --region=${REGION}

# 安装agnones
helm repo add agones https://agones.dev/chart/stable
helm repo update
# kubectl create namespace agones-system
helm install my-release --namespace agones-system --create-namespace agones/agones
# helm install sd-agones-release --namespace agones-system --version 1.30.0  agones/agones
# helm install sd-agones-release --namespace agones-system -f ./agones/values.yaml agones/agones


# 查看安装后的版本
helm list --namespace agones-system 


# 只卸载k8s内部的包
helm uninstall my-release --namespace agones-system
# helm uninstall sd-agones-release --namespace agones-system
kubectl get namespaces
 
#
# 硬核清理:
gcloud container clusters delete testagones --region=${REGION}